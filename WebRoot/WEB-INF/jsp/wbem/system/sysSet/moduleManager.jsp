<%@ page language="java" contentType="text/html; charset=GBK" pageEncoding="GBK"%>
<%@include file="/WEB-INF/jsp/wbem/pub/header.jsp" %>
<link rel="stylesheet" href="/common/css/ztree/zTreeStyle.css" />
<style>
	.line {
	    height: auto;}
	a {
	    color: #fff;
	    text-decoration: initial;}
	a:hover{background-color: #fff;
	    text-decoration: initial;}
	body{margin-top:-10px;}
	#footer{font-family: "Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","WenQuanYi Micro Hei",sans-serif;
	    font-size: 12px;
	    color: #666;
	}
	#footer a{ color: #666;}
	#footer a:hover{color:#f60; background-color:#2f332a}
	.layui-layer-btn a:hover{
		color: #000;
	}
</style>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3">
	    <div class="widget-box">
			<div class="widget-title">
				<span class="icon"><i class="icon-th"></i></span><h5>模块选择</h5>
				<div class="label" style="background-color: #EFEFEF;box-shadow:0 0 0 0;margin:0;">
					<button type="button" class="btn btn-success"  id="createTeamGroup" style="display: none;">新增</button>
					<button type="button" class="btn btn-success"  id="updateTeamGroup" style="display: none;">修改</button>
					<button type="button" class="btn btn-success"  id="deleteTeamGroup" style="display: none;">删除</button>
				</div>
	        </div>
			<div class="widget-content nopadding">
				<form action="#" method="get" class="form-horizontal" >
				<ul id="commonTree" class="ztree" ></ul>
				</form>
			</div>
		</div>
    </div>
    <div class="span9">
      <div class="widget-box">
		<div class="widget-title">
			<span class="icon"><i class="icon-th"></i></span><h5>权限列表</h5>
			<div class="label" style="background-color: #EFEFEF;box-shadow:0 0 0 0;margin:0;">
				<!-- <input type="text" style="margin-bottom:0" id="userName_s" placeholder="姓名">
				<button class="btn btn-info" id="tableSearch">查询</button>
				<button type="button" class="btn btn-info" id="resetSearch">撤销筛选</button> -->
				<button type="button" class="btn btn-success"  id="createUser" disabled="disabled">新增</button>
				<!-- <button type="button" class="btn btn-success" id="updateUser">修改成员</button>
				<button type="button" class="btn btn-success" id="deleteUser">删除成员</button> -->
			</div>
        </div>
		<div class="widget-content nopadding">
			<table class="table table-bordered data-table">
				<thead>
	                <tr> 
						<th>序号</th>
						<th>权限名称</th>
						<th>权限标识</th>
						<th>权限类型</th>
						<th hidden="hidden">parentID</th>
						<th>URL</th>
						<th>优先级</th>
						<th>状态</th>
						<th hidden="hidden">description</th>
						<th>操作</th>
					</tr>
				</thead>
			</table>
		</div>
	</div>
    </div>
  </div>
</div>

<div id="cemModelMenu" class="container-fluid"  hidden="hidden">
	 <form action="#" method="get" class="form-horizontal">
	     <div class="control-group noborder-bottom"> <!-- noborder-bottom -->
	       <label class="control-label" id="modelabel">模块名称菜单名称</label>
	       <div class="controls">
	         <input type="text" id="mmName" class="span4" value="" />
	       </div>
	     </div>
	     <div class="control-group noborder-bottom" id="modelProDiv">
	       <label class="control-label">模块属性</label>
	       <!-- <div class="controls">
	         <input type="radio" name="mmRadio" id="mmRadion1" value="1">启用
	         <input type="radio" name="mmRadio" id="mmRadion2" value="0">禁用
	       </div> -->
	       <div class="controls">
	         <input type="radio" name="modelRadio" id="modelRadio1" value="1" checked="checked">电脑端
	         <input type="radio" name="modelRadio" id="modelRadio2" value="0">移动端
	       </div>
	     </div>
	     <div class="control-group noborder-bottom" id="mmpMarkDiv"> <!-- noborder-bottom -->
	       <label class="control-label">权限标识</label>
	       <div class="controls">
	       	 <input type="text" id="mmpMark_show" class="span3" value="" disabled="disabled" />
	         <input type="text" id="mmpMark" class="span1" style="width: 21%" value="" />
	       </div>
	     </div>
	     <div class="control-group noborder-bottom">
	       <label class="control-label">是否有效</label>
	       <!-- <div class="controls">
	         <input type="radio" name="mmRadio" id="mmRadion1" value="1">启用
	         <input type="radio" name="mmRadio" id="mmRadion2" value="0">禁用
	       </div> -->
	       <div class="controls">
	         <input type="radio" name="mmRadio" id="mmRadio1" value="1">启用
	         <input type="radio" name="mmRadio" id="mmRadio2" value="0">禁用
	       </div>
	     </div>
	     
	     <div class="control-group noborder-bottom" id="mmurlDiv"> <!-- noborder-bottom -->
	       <label class="control-label">URL</label>
	       <div class="controls">
	         <input type="text" id="mmurl" class="span4" value="" />
	       </div>
	     </div>
	     <div class="control-group noborder-bottom">
	       <label class="control-label">排序号</label>
	       <div class="controls">
	         <input type="text" id="priority" class="span4" value="" />
	       </div>
	     </div>
     </form>
</div>
<div id="cePermission" class="container-fluid"  hidden="hidden">
	 <form action="#" method="get" class="form-horizontal">
	     <div class="control-group noborder-bottom"> <!-- noborder-bottom -->
	       <label class="control-label">权限名称</label>
	       <div class="controls">
	         <input type="text" id="promissionName" class="span4" value="" />
	       </div>
	     </div>
	     <div class="control-group noborder-bottom"> <!-- noborder-bottom -->
	       <label class="control-label">权限标识</label>
	       <div class="controls">
	       	 <input type="text" id="promissionMark_show" class="span3" value="" disabled="disabled"/>
	         <input type="text" id="promissionMark" class="span1" style="width: 21%" value="" />
	       </div>
	     </div>
	     <!-- <div class="control-group noborder-bottom" id="systemDisplay">
	       <label class="control-label">类型</label>
	       <div class="controls">
	         <select id="promissionTypeSele" class="span2" name="exceptSelect">
	              <option value="page">子页面</option>
	              <option value="button">操作按钮</option>
	         </select>
	       </div>
	     </div> -->
	     <div class="control-group noborder-bottom" id="systemDisplay">
	       <label class="control-label">类型</label>
	       <div class="controls">
	         <input type="radio" name="promissionTypeRadio" id="promissionTypeRadio1" value="page" style="margin-top: -4px;">页面
	         <input type="radio" name="promissionTypeRadio" id="promissionTypeRadio2" value="button" style="margin-top: -4px;">操作按钮
	       </div>
	     </div>
	     <div class="control-group noborder-bottom"> <!-- noborder-bottom -->
	       <label class="control-label">URL</label>
	       <div class="controls">
	         <input type="text" id="url" class="span4" value="" />                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
	       </div>
	     </div>
	     <div class="control-group noborder-bottom">
	       <label class="control-label">是否有效</label>
	       <div class="controls">
	         <input type="radio" name="permissionRadio" id="permissionRadio1" value="1" style="margin-top: -4px;">启用
	         <input type="radio" name="permissionRadio" id="permissionRadio2" value="0" style="margin-top: -4px;">禁用
	       </div>
	     </div>
	     <div class="control-group noborder-bottom"> <!-- noborder-bottom -->
	       <label class="control-label">排序号</label>
	       <div class="controls">
	         <input type="text" id="permissionAvail" class="span4" value="" />
	       </div>
	     </div>
     </form>
</div>
<div id="copyDiv">

</div>

<%@include file="/wbem/include/include_base_js.jsp" %>
<%@include file="/wbem/include/include_tables_js.jsp" %>
<script type="text/javascript" src="/common/js/ztree/jquery.ztree.core-3.5.min.js" ></script>
<script type="text/javascript">
	 var setting = {
		view: {
			selectedMulti: false
		},
		async: {
			enable: true,
			url:"/wbem/system/sysSet/getSubSystemModel.action",
			type:"post",
			autoParam:["id=parentID","permissionType","url"],
		},
		callback: {
			onAsyncSuccess: onAsyncSuccess,
			onClick: zTreeOnClick
		},
		data:{
			simpleData:{
				enable:true
			}
		}
		
	}; 
	function beforeClick(treeId, treeNode, clickFlag){
	}
	var table=null;
	var permissionID='';
	var permissionType='';
	var url='';
	var permissionMark='';
	var subpermissionMark='';
	var name='';
	var available='';
	var priority='';
	var parentID='';
	function zTreeOnClick(event, treeId, treeNode) {
		$("#"+treeId).find("a").removeAttr("href");
		$("#"+treeId).find("a").removeAttr("target");
		permissionID=treeNode.id;
		permissionType=treeNode.permissionType;
		url=treeNode.url;
		permissionMark=treeNode.permissionMark;
		name=treeNode.name;
		subpermissionMark=treeNode.subpermissionMark;
		available=treeNode.available;
		priority=treeNode.priority;
		parentID=treeNode.parId;
		if(permissionID=='0'&& permissionType=='0' && url=='0'){//点击兆盛---新增模块
			$("#createTeamGroup").text("新增模块").show();
			$("#createUser").attr("disabled",true);
			$("#updateTeamGroup").hide();
			$("#deleteTeamGroup").hide();
			$("#modelProDiv").show();
			//return;
		}else if(permissionID !='0'&&  (permissionType=='subsystem' || permissionType=='subsystemMobile') ){//点击模块---新增菜单
			$("#createTeamGroup").text("新增菜单").show();
			$("#createUser").attr("disabled",true);
			$("#updateTeamGroup").show();
			$("#deleteTeamGroup").show();
			$("#modelProDiv").hide();
			//return;
		}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')&&(url==null || url ==''|| url.lastIndexOf(".action")==-1)){//点击菜单---新增页面
			$("#createTeamGroup").text("新增子菜单").show();
			$("#createUser").attr("disabled",true);
			$("#updateTeamGroup").show();
			$("#deleteTeamGroup").show();
			$("#modelProDiv").hide();
			//return;
		}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')&& (url !=null && url !='' && url.lastIndexOf(".action")!=-1)){//点击子菜单---新增子页面
			$("#createTeamGroup").hide();
			$("#createUser").attr("disabled",false);
			$("#modelProDiv").hide();
			$("#updateTeamGroup").show();
			$("#deleteTeamGroup").show();
		}
		if(table==null){
			table=$('.data-table').DataTable({
				"ajax": {
					type: "post",//后台指定了方式。
		         	url: "/wbem/system/sysSet/getSubPageAndCrduTableList.action",
					data:function(d){			//外部参数传递
						d.parentID=permissionID;
			         	//d.projectId = projectId;
			         	//d.userName = encodeURI($('#userName_s').val());
			        }
		         },
		         "columns":[
		         	{"data":"index"},
		         	{"data":"permissionName"},
		         	{"data":"permissionMark"},
		         	{"data":"permissionType"},
		         	{"data":"parentID"},
		         	{"data":"url"},
		         	{"data":"priority"},
		         	{"data":"available","render":function(data, type, row, meta){
		         			if(data=="false"){
		         				return "禁用";
		         			}else if(data=="true"){
		         				return "启用";
		         			} 
		         	}},
		         	{"data":"description"},
		         	{"data":"permissionID"}
		         	
		         	
		         ],
		         columnDefs:[
					 {
			         	targets:9,"render":function(data, type, row, meta){
			       			return  "<a style='color:#FAA732' href='#' onclick='editSysModel(\"" + data + "\",\"" + row.permissionName + "\",\"" + row.permissionMark + "\",\"" + row.permissionType + "\",\"" + row.url + "\",\"" + row.available + "\",\"" + row.priority + "\")'>编辑</a>&nbsp;"+
			       					"<a style='color:#FAA732' href='#' onclick='copyPermission(\"" + row.permissionMark + "\")' >复制</a>&nbsp;";
       								
			         	}
			         }, 
			           {
						"targets": [4,8],
						"visible": false,
			         } 
        ]
			});
			$('select[name!="exceptSelect"]').select2();
		}else{
			$('.data-table').DataTable().ajax.reload();	
		}
	};
	
	function onAsyncSuccess(event, treeId, treeNode, msg) {
	};
	function filter(treeId, parentNode, childNodes) {
		return childNodes;
	}
	function copyPermission(pMark){
	  	var str='<input type="text" size=20 id="biao1" value="测试数据">';
	  	$("#copyDiv").append(str);
	  	$("#biao1").val("@RequiresPermissions(value=\""+pMark+"\")");
		var Url2=document.getElementById("biao1");
		Url2.select(); // 选择对象
		document.execCommand("Copy"); // 执行浏览器复制命令
		$("#copyDiv").empty(); // 执行浏览器复制命令
		layer.msg('已复制好，可贴粘', {
		    time: 1000, //20s后自动关闭
		});
	}
//编辑组成员
	function editSysModel(permissionID,permissionName,permissionMark,permissionType,url,available,priority){
		//pMark=pType+permissionMark.substring(permissionMark.lastIndexOf(":")+1, permissionMark.length)+":"+$("#promissionMark").val();
		$("#promissionName").val(permissionName);
		$("#promissionMark").val(permissionMark.substring(permissionMark.lastIndexOf(":")+1));
		$("#promissionMark_show").val(permissionMark.substring(0,permissionMark.lastIndexOf(":")+1));
		/* $("#promissionTypeSele").children('option').each(function(index){
			if($(this).val()==permissionType){
				$(this).attr("selected", "selected");
			};
		}); */
		if(permissionType=="page"){
			$("#promissionTypeRadio1").prop("checked",true);
			$("#systemDisplay").show();
		}else if(permissionType=="button"){
			$("#promissionTypeRadio2").prop("checked",true);
			$("#systemDisplay").show();
		}else{
			$("#promissionTypeRadio2").prop("checked",false);
			$("#promissionTypeRadio1").prop("checked",false);
			$("#systemDisplay").hide();
		}
		$("#url").val(url);
		if(available=="true"){
			$("#permissionRadio1").prop("checked",true);
		}else if(available=="false"){
			$("#permissionRadio2").prop("checked",true);
		}
		$("#permissionAvail").val(priority);
		var pName='';
		var pMark='';
		var pType='';
		var parID='';
		var ul='';
		var prity='';
		var avaie='';
		var descrip='';	
		layer.open({
	        type: 1,
	        title: '编辑权限',
	        maxmin: false,       //开启最大最小化
	        shadeClose: false, //点击遮罩关闭层
	        area : ['540px' , '400px'],
	        btn: ['确定', '取消'],
			yes: function(index, layero){ //或者使用btn1
				pName=encodeURI($("#promissionName").val());
				//pType=$("#promissionTypeSele").children('option:selected').val();
				$("input:radio[name=promissionTypeRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								pType='page';
							}else if(index=='1'){
								pType='button';
							}
						}
				});
				if(permissionType !='page' && permissionType !='button'){
					pType=permissionType;
				}	
				pMark=pType+permissionMark.substring(permissionMark.indexOf(":", 0), permissionMark.lastIndexOf(":"))+":"+$("#promissionMark").val();
				$("input:radio[name=permissionRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								avaie='1';
							}else if(index=='1'){
								avaie='0';
							}
						}
					});
				prity=$("#permissionAvail").val();
				ul=$("#url").val();
				parID=parentID;
				descrip='';
				//alert("pname "+pName+" mark "+pMark+" type "+pType+" parid "+parID+" ul "+ul+" av "+avaie+" pri "+prity);
				//return;
			    $.ajax({
		 	          url : '/wbem/system/sysSet/updateSubSystemModel.action',//这个就是请求地址对应sAjaxSource
			          data : {permissionID:permissionID,permissionName:pName, permissionMark:pMark, permissionType:pType, parentID:parID, url:ul, priority:prity, available:avaie, description:descrip},//这个是把datatable的一些基本数据传给后台,比如起始位置,每页显示的行数
			          type : 'post',
			          dataType : 'json',
			          success : function(result) {          
			          	if(result ==1){
			          		layer.close(index);
							table.draw();
			            }else if(result==-1)  {
			              	layer.alert("已经为该系统创建分组！");
			            }else  {
			              	layer.alert("编辑失败");
			            }
			          },
			          error : function(msg) {
			          	layer.alert("系统异常，联系管理员");
			          }
				});
			},
			cancel: function(index){ //或者使用btn2
			    //
			},
	        content: $("#cePermission")
	    });
	}
	function cePageOrButton (){
		var pName='';
		var pMark='';
		var pType='';
		var parID='';
		var ul='';
		var prity='';
		var avaie='';
		var descrip='';	
		layer.open({
	        type: 1,
	        title: '新增团队',
	        maxmin: false,       //开启最大最小化
	        shadeClose: false, //点击遮罩关闭层
	        area : ['540px' , '400px'],
	        btn: ['确定', '取消'],
			yes: function(index, layero){ //或者使用btn1
				pName=encodeURI($("#promissionName").val());
				//pType=$("#promissionTypeSele").children('option:selected').val();
				$("input:radio[name=promissionTypeRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								pType='page';
							}else if(index=='1'){
								pType='button';
							}
						}
					});
					
				pMark=pType+permissionMark.substring(permissionMark.indexOf(":", 0), permissionMark.length)+":"+$("#promissionMark").val();
				$("input:radio[name=permissionRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								avaie='1';
							}else if(index=='1'){
								avaie='0';
							}
						}
					});
				prity=$("#permissionAvail").val();
				ul=$("#url").val();
				parID=permissionID;
				descrip='';
				//alert("pname "+pName+" mark "+pMark+" type "+pType+" parid "+parID+" ul "+ul+" av "+avaie+" pri "+prity);
			    $.ajax({
		 	          url : '/wbem/system/sysSet/createSubSystemModel.action',//这个就是请求地址对应sAjaxSource
			          data : {permissionName:pName, permissionMark:pMark, permissionType:pType, parentID:parID, url:ul, priority:prity, available:avaie, description:descrip},//这个是把datatable的一些基本数据传给后台,比如起始位置,每页显示的行数
			          type : 'post',
			          dataType : 'json',
			          success : function(result) {          
			          	if(result ==1){
			          		layer.close(index);
							table.draw();
			            }else if(result==-1)  {
			              	layer.alert("已经为该系统创建分组！");
			            }else  {
			              	layer.alert("编辑失败");
			            }
			          },
			          error : function(msg) {
			          	layer.alert("系统异常，联系管理员");
			          }
				});
			},
			cancel: function(index){ //或者使用btn2
			    //
			},
	        content: $("#cePermission")
	    });
	}
$(document).ready(function(){
	//初始化加载树
	$.fn.zTree.init($("#commonTree"), setting);
	
	$("#tableSearch").click(function(){
		table.draw();
	});

	$("#resetSearch").click(function(){
		$('#userName').val("");
		table.draw();
	});
	//新增成员按钮事件
	$("#createUser").on('click',function(){
		$("#cePermission").find("input").val('');
		$("#permissionRadio1").prop("checked",true);
		$("#promissionTypeRadio1").prop("checked",true);
		$("#promissionMark_show").val("page"+permissionMark.substring(permissionMark.indexOf(":", 0), permissionMark.length)+":");
		cePageOrButton();
	});

	//新增团队事件
	$("#createTeamGroup").on('click',function(){
		if(permissionID==''&& permissionType=='' && url==''){//什么也没点击
				layer.alert("选中树节点");
				return;
		}
		$("#cemModelMenu").find("input").val("");//先清空内容
		$("#mmRadio1").prop("checked",true);
		if(permissionID=='0'&& permissionType=='0' && url=='0'){//点击兆盛---新增模块
			$("#mmurlDiv").hide();
			$("#mmpMark_show").val("subsystem:");
			$("#modelabel").text("模块名称");
		}else if(permissionID !='0'&&  (permissionType=='subsystem' || permissionType=='subsystemMobile') ){//点击模块---新增菜单
			$("#mmurlDiv").hide();
			$("#mmpMark_show").val("menu:");
			$("#modelabel").text("菜单名称");
		}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')){//点击菜单---新增页面
			$("#mmurlDiv").show();
			$("#mmpMark_show").val(permissionMark+":");
			$("#modelabel").text("子菜单名称");
		}
		createSubSystemModel();
		 
	});
	$("input:radio[name=modelRadio]").on("click",function(){
		if($(this).prop("checked")==true){
			if($(this).attr("id")=='modelRadio1'){
				$("#mmpMark_show").val("subsystem:");
			}else if($(this).attr("id")=='modelRadio2'){
				$("#mmpMark_show").val("subsystemMobile:");
			}
		}
	});
	function createSubSystemModel(){
		var pName='';
		var pMark='';
		var pType='';
		var parID='';
		var ul='';
		var prity='';
		var avaie='';
		var descrip='';	
		layer.open({
	        type: 1,
	        title: $("#modelabel").text(),
	        maxmin: false,       //开启最大最小化
	        shadeClose: false, //点击遮罩关闭层
	        area : ['540px' , '350px'],
	        btn: ['确定', '取消'],
			yes: function(index, layero){ //或者使用btn1
				pName=encodeURI($("#mmName").val());
				$("input:radio[name=mmRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								avaie='1';
							}else if(index=='1'){
								avaie='0';
							}
						}
					});
				prity=$("#priority").val();	
				if(permissionID=='0'&& permissionType=='0' && url=='0'){//点击兆盛---新增模块
					$("input:radio[name=modelRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								pMark='subsystem:'+$("#mmpMark").val();
								pType="subsystem";
							}else if(index=='1'){
								pMark='subsystemMobile:'+$("#mmpMark").val();
								pType="subsystemMobile";
							}
						}
					});
					//pMark='subsystem:'+$("#mmpMark").val();
					//pType="subsystem";
					parID='0';
					ul='';
					descrip='';
				}else if(permissionID !='0'&&  (permissionType=='subsystem' || permissionType=='subsystemMobile') ){//点击模块---新增菜单
					pMark='menu:'+$("#mmpMark").val();
					pType="menu";
					parID=permissionID;
					ul='';
					descrip='';
				}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')){//点击菜单---新增页面
					pMark=permissionMark+":"+$("#mmpMark").val();
					pType="menu";
					parID=permissionID;
					ul=$("#mmurl").val();
					descrip='';
				}
				//alert("pname "+pName+" mark "+pMark+" type "+pType+" parid "+parID+" ul "+ul+" av "+avaie+" pri "+prity);
			    $.ajax({
		 	          url : '/wbem/system/sysSet/createSubSystemModel.action',//这个就是请求地址对应sAjaxSource
			          data : { permissionName:pName, permissionMark:pMark, permissionType:pType, parentID:parID, url:ul, priority:prity, available:avaie, description:descrip},//这个是把datatable的一些基本数据传给后台,比如起始位置,每页显示的行数
			          type : 'post',
			          dataType : 'json',
			          success : function(result) {          
			          	if(result ==1){
			          		layer.close(index);
							$.fn.zTree.init($("#commonTree"), setting);
			            }else if(result==-1)  {
			              	layer.alert("已经为该系统创建分组！");
			            }else  {
			              	layer.alert("编辑失败");
			            }
			          },
			          error : function(msg) {
			          	layer.alert("系统异常，联系管理员");
			          }
				});
			},
			cancel: function(index){ //或者使用btn2
			    //
			},
	        content: $("#cemModelMenu")
	    });
	}
		//修改团队事件
	$("#updateTeamGroup").on('click',function(){
		if(permissionID==''&& permissionType=='' && url==''){//什么也没点击
				layer.alert("选中树节点");
				return;
		}
		if(permissionID=='0'&& permissionType=='0' && url=='0'){//点击兆盛
				layer.alert("第一级目录不能修改");
				return;
		}else if(permissionID !='0'&&  (permissionType=='subsystem' || permissionType=='subsystemMobile') ){//点击模块
			$("#mmurlDiv").hide();
			$("#mmpMark_show").val(permissionType+":");
			$("#modelabel").text("模块名称");
			updateSubSystemModel("修改模块"); 
		}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')&&(url==null || url ==''|| url.lastIndexOf(".action")==-1)){//点击菜单---新增页面
			$("#mmurlDiv").hide();
			$("#modelabel").text("菜单名称");
			$("#mmpMark_show").val("menu:");
			updateSubSystemModel("修改菜单");
		}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')&& (url !=null && url !='' && url.lastIndexOf(".action")!=-1)){//点击页面---新增子页面
			updateSubSystemModel("修改子菜单");
			$("#mmpMark_show").val(permissionMark.substring(0, permissionMark.lastIndexOf(":")+1));
			$("#mmurlDiv").show();
			$("#modelabel").text("子菜单名称");
		}
		$("#mmName").val(name);
		if(available==true){
			$("#mmRadio1").prop("checked",true);
		}else if(available==false){
			$("#mmRadio2").prop("checked",true);
		}
		$("#mmpMark").val(subpermissionMark);
		$("#priority").val(priority);	
		$("#mmurl").val(url);
	});
		function updateSubSystemModel(title){
		var pName='';
		var pMark='';
		var pType='';
		var parID='';
		var ul='';
		var prity='';
		var avaie='';
		var descrip='';	
		layer.open({ 
	        type: 1,
	        title: title,
	        maxmin: false,       //开启最大最小化
	        shadeClose: false, //点击遮罩关闭层
	        area : ['540px' , '350px'],
	        btn: ['确定', '取消'],
			yes: function(index, layero){ //或者使用btn1
				pName=encodeURI($("#mmName").val());
				$("input:radio[name=mmRadio]").each(function(index){
						if($(this).prop("checked")==true){
							if(index=='0'){
								avaie='1';
							}else if(index=='1'){
								avaie='0';
							}
						}
					});
				prity=$("#priority").val();	
				if(permissionID=='0'&& permissionType=='0' && url=='0'){//点击兆盛---不修改
					layer.alert("不能修改");
					return;
				}else if(permissionID !='0'&&  (permissionType=='subsystem' || permissionType=='subsystemMobile')){//点击模块---修改模块
					pMark=permissionType+':'+$("#mmpMark").val();
					pType=permissionType;
					parID='0';
					ul='';
					descrip='';
				}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')&& (url==null || url ==''|| url.lastIndexOf(".action")==-1)){//点击菜单---修改菜单
					pMark='menu:'+$("#mmpMark").val();
					pType="menu";
					parID=parentID;
					ul='';
					descrip='';
				}else if((permissionID !='' && permissionID !='0' && permissionID !=null)&& (permissionType=='menu')&& (url.lastIndexOf(".action")!=-1)){//点击子菜单---修改子菜单
					pMark=permissionMark+":"+$("#mmpMark").val();
					pType="menu";
					parID=parentID;
					ul=$("#mmurl").val();
					descrip='';
				}
				//alert("pname "+pName+" mark "+pMark+" type "+pType+" parid "+parID+" ul "+ul+" av "+avaie+" pri "+prity);
			    $.ajax({
		 	          url : '/wbem/system/sysSet/updateSubSystemModel.action',//这个就是请求地址对应sAjaxSource
			          data : { permissionID:permissionID,permissionName:pName, permissionMark:pMark, permissionType:pType, parentID:parID, url:ul, priority:prity, available:avaie, description:descrip},//这个是把datatable的一些基本数据传给后台,比如起始位置,每页显示的行数
			          type : 'post',
			          dataType : 'json',
			          success : function(result) {          
			          	if(result ==1){
			          		layer.close(index);
							$.fn.zTree.init($("#commonTree"), setting);
			            }else  {
			              	layer.alert("编辑失败");
			            }
			          },
			          error : function(msg) {
			          	layer.alert("系统异常，联系管理员");
			          }
				});
			},
			cancel: function(index){ //或者使用btn2
			    //
			},
	        content: $("#cemModelMenu")
	    });
	}
	$("#deleteTeamGroup").on('click',function(){
		if(permissionID==''&& permissionType=='' && url==''){//什么也没点击
				layer.alert("选中要删除的节点");
				return;
		}
		if(permissionID=='0'&& permissionType=='0' && url=='0'){//点击兆盛
				layer.alert("第一级目录不能删除");
				return;
		}
		
		layer.confirm('确定要删除该组吗？', {
			  btn: ['确定','取消'] //按钮
			}, function(index){
				  $.ajax({
			 	          url : '/wbem/system/sysSet/deleteSubSystemModel.action',//这个就是请求地址对应sAjaxSource
				          data : {permissionID:permissionID,permissionType:permissionType,url:url},//这个是把datatable的一些基本数据传给后台,比如起始位置,每页显示的行数
				          type : 'post',
				          dataType : 'json',
				          success : function(result) {          
				          	if(result ==-1){
				          		layer.alert("该管理模块下有菜单项，不能删除！");
				            }else if(result ==-2){
				          		layer.alert("该菜单下有子菜单，不能删除！");
				            }else if(result ==-3){
				          		layer.alert("该子菜单下有页面或相应的操作，不能删除！");
				            }else if(result ==1) {
				            	layer.close(index);
				              	$.fn.zTree.init($("#commonTree"), setting);
				            }else{
				            	layer.alert("删除失败");
				            }
				          },
				          error : function(msg) {
				          	layer.alert("系统异常，联系管理员");
				          }
				});
			}, function(){
			  
		});
		
	});
}); 
</script> 
<%@include file="/WEB-INF/jsp/wbem/pub/footer.jsp" %>